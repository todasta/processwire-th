var ProcessWireAdminTheme={init:function(){this.setupInputfields();this.setupTooltips();this.checkLayout()},ready:function(){this.setupCloneButton();ProcessWireAdmin.init();this.setupSearch();this.setupSideNav();var b=$("body");$(document).on("wiretabclick opened",function(c){$("body").addClass("pw-fake-resize");$(window).resize();setTimeout(function(){$("body").removeClass("pw-fake-resize")},100)});$("a.notice-remove","#notices").click(function(){$("#notices").slideUp("fast",function(){$(this).remove()});return false});$("a.pw-logo-link").click(this.logoClickEvent);$("#_ProcessPageEditView").click(function(c){c.stopPropagation()});var a=null;$(window).resize(function(){if(a){return}a=setTimeout(function(){ProcessWireAdminTheme.windowResized();a=null},250)});this.setupMasthead();this.setupWireTabs();b.removeClass("pw-init").addClass("pw-ready")},setupWireTabs:function(){var a=$(".WireTabs");if(a.length){$(document).on("wiretabclick",function(b,c){ProcessWireAdminTheme.wireTabClick(c)});setTimeout(function(){var c=a.children(".uk-active");if(c.length){var b=$(c.find("a").attr("href"));if(b.length){ProcessWireAdminTheme.wireTabClick(b)}}},500)}},wireTabClick:function(a){if(!a.length){return}var d=null;var b=null;if(a.hasClass("InputfieldWrapper")){b=a.children(".Inputfields").children(".Inputfield:eq(0)");d=b.children(".InputfieldHeader")}else{if(a.hasClass("Inputfield")){b=a;d=a.children(".InputfieldHeader")}}if(!d||!d.length){return}var i=false;var c=["InputfieldIsPrimary","InputfieldIsWarning","InputfieldIsError","InputfieldIsHighlight","InputfieldIsSuccess"];for(var f=0;f<c.length;f++){if(b.hasClass(c[f])){i=true;break}}if(i){return}var h=$("#_"+a.attr("id")).parent();if(!h.length){return}var g=h.children("a");var e=d.css("background-color");if(h.css("background-color")!=e&&g.css("background-color")!=e){h.addClass("pw-tab-muted")}},checkLayout:function(){if($("body").attr("class").indexOf("pw-layout-sidenav")==-1){return}if($("body").hasClass("pw-layout-sidenav-init")){return}if(typeof parent=="undefined"||typeof parent.isPresent=="undefined"){var a=window.location.href;if(a.indexOf("layout=")>-1){a=a.replace(/([?&]layout)=[-_a-zA-Z0-9]+/,"$1=sidenav-init")}else{a+=(a.indexOf("?")>0?"&":"?")+"layout=sidenav-init"}window.location.href=a}},windowResized:function(){if($("body").hasClass("pw-fake-resize")){return}this.setupMasthead()},setupMasthead:function(){var b=$("#pw-masthead");var e=$("#pw-masthead-mobile");var c=$(window).width();var a=0;var d=0;if(c>767){d=parseInt(b.data("pw-height"));a=b.children(".pw-container").height()}else{a=999}if(b.hasClass("uk-hidden")){b.removeClass("uk-hidden")}if(a>d){if(!b.hasClass("pw-masthead-hidden")){b.addClass("pw-masthead-hidden").css({position:"absolute",top:"-9999px"});e.removeClass("uk-hidden");$("#offcanvas-toggle").removeClass("uk-hidden")}}else{if(b.hasClass("pw-masthead-hidden")){e.addClass("uk-hidden");b.removeClass("pw-masthead-hidden").css({position:"relative",top:0});$("#offcanvas-toggle").addClass("uk-hidden")}}},setupCloneButton:function(){if($("body").is(".modal")){return}var c=$("button.pw-head-button, button.head_button_clone");if(c.length==0){return}var a=$("#pw-content-head-buttons");var e=null;var h=null;var d={};c.each(function(){var m=$(this);var k=m.parent("a");var j;if(k.length>0){j=m.parent("a").clone(true);a.prepend(j)}else{if(m.hasClass("pw-head-button")||m.hasClass("head_button_clone")){j=m.clone(true);j.attr("data-from_id",m.attr("id")).attr("id",m.attr("id")+"_copy").addClass("pw-head-button");j.click(function(){$("#"+$(this).attr("data-from_id")).click();return false});if(j.hasClass("pw-button-dropdown-toggle")){var l=j.attr("id").replace("pw-dropdown-toggle-","");d[l]=j}else{if(j.hasClass("pw-button-dropdown-main")){var i=$("<span></span>").addClass("pw-button-dropdown-wrap");i.append(j).addClass("uk-float-right");a.prepend(i)}else{j.addClass("uk-float-right");a.prepend(j)}}}}});for(var g in d){var b=d[g];var f=$("#"+g);f.after(b)}},setupSearch:function(){$.widget("custom.adminsearchautocomplete",$.ui.autocomplete,{_renderMenu:function(c,a){var d=this;var b="";c.addClass("pw-dropdown-menu-shorter uk-nav uk-nav-default");c.css("z-index",9999);$.each(a,function(e,f){if(f.type!=b){if(b.length){$("<li class='uk-nav-divider'></li>").appendTo(c)}$("<li>"+f.type+"</li>").addClass("uk-nav-header").appendTo(c);b=f.type}d._renderItemData(c,f)})},_renderItem:function(c,d){if(d.label==d.template){d.template=""}var a=$("<span></span>").text(d.label).css("margin-right","3px");if(d.unpublished){a.css("text-decoration","line-through")}if(d.hidden){a.addClass("ui-priority-secondary")}if(d.icon.length){var b=$("<i></i>").addClass("fa fa-fw fa-"+d.icon).css("margin-right","2px");a.prepend(b)}var e=$("<a></a>").attr("href",d.edit_url).attr("title",d.tip).append(a).append($("<small class='uk-text-muted'></small>").text(d.template));if(d.edit_url=="#"||!d.edit_url.length){e.removeAttr("href")}return $("<li></li>").append(e).appendTo(c)}});$(".pw-search-form").each(function(){var b=$(this);var c=b.find(".pw-search-input");var a={my:"right top",at:"right bottom"};if(b.closest(".uk-offcanvas-bar").length){a.my="left top";a.at="left bottom"}c.click(function(d){d.stopPropagation()});c.adminsearchautocomplete({minLength:2,position:a,search:function(d,e){b.find(".pw-search-icon").addClass("uk-hidden");b.find(".pw-spinner-icon").removeClass("uk-hidden")},open:function(d,e){},close:function(d,e){},source:function(f,d){var e=c.parents("form").attr("data-action")+"?q="+f.term;$.getJSON(e,function(h){var g=h.matches.length;if(g<h.total){}else{}b.find(".pw-search-icon").removeClass("uk-hidden");b.find(".pw-spinner-icon").addClass("uk-hidden");d($.map(h.matches,function(i){return{label:i.title,value:i.title,page_id:i.id,template:i.template_label?i.template_label:"",edit_url:i.editUrl,type:i.type,tip:i.tip,unpublished:(typeof i.unpublished!="undefined"?i.unpublished:false),hidden:(typeof i.hidden!="undefined"?i.hidden:false),locked:(typeof i.locked!="undefined"?i.locked:false),icon:(typeof i.icon!="undefined"?i.icon:"")}}))})},select:function(d,e){$(this).val("");if(typeof d.key!=="undefined"){d.preventDefault();if(e.item.edit_url==="#"||e.item.edit_url.length<1){return false}if(typeof parent.isPresent=="undefined"){window.location=e.item.edit_url}else{parent.jQuery("#pw-admin-main")[0].contentWindow.document.location.href=e.item.edit_url}}}}).focus(function(){}).blur(function(){})})},setupSideNav:function(){$(".pw-sidebar-nav").on("click","a",function(d){var e=$(this);if(!e.hasClass("pw-has-ajax-items")){d.stopPropagation();return}var b=e.closest("li").find("ul");var a=$(this).attr("data-json");if(b.hasClass("navJSON")){return false}var c=$("<li class='pw-nav-spinner'><i class='fa fa-spin fa-spinner'></i></li>");b.append(c);$.getJSON(a,function(g){var i=e.clone();var f=i.find("i");if(!f.length){f=$("<i></i>");i.prepend(f)}f.attr("class","fa fa-fw fa-arrow-circle-right pw-nav-icon");i.removeAttr("data-json").removeAttr("class");i.find("small").remove();var h=$("<li></li>").addClass("pw-nav-dup").append(i);b.append(h);if(g.add){var h=$("<li class='pw-nav-add'><a href='"+g.url+g.add.url+"'><i class='fa fa-fw fa-"+g.add.icon+" pw-nav-icon'></i>"+g.add.label+"</a></li>");b.append(h)}$.each(g.list,function(k){if(this.label.indexOf("<span")>-1){this.label=this.label.replace(/<\/?span[^>]*>/g,"")}var q="";var r=$("<div>"+this.label+"</div>");var s=r.text();if(s.length>30){var o=r.find("small");if(o.length){o.remove()}s=r.text();s=s.substring(0,30);var k=s.lastIndexOf(" ");if(k>3){s=s.substring(0,k)+"â€¦ "}r.html(s);if(o.length){r.append(o)}}s=r.html().replace("&nbsp;"," ");if(this.icon){q="<i class='fa fa-fw fa-"+this.icon+" pw-nav-icon'></i>"}var j=this.url.indexOf("/")===0?this.url:g.url+this.url;var l=$("<a href='"+j+"'>"+q+s+"</a>");var p=$("<li></li>").append(l);if(this.navJSON!="undefined"&&this.navJSON){l.addClass("pw-has-items pw-has-ajax-items").attr("data-json",this.navJSON);var m=$("<ul class='uk-nav-sub uk-nav-parent-icon'></ul>");p.addClass("uk-parent").append(m);UIkit.nav(m,{multiple:true})}if(typeof this.className!="undefined"&&this.className&&this.className.length){p.addClass(this.className)}if(p.hasClass("pw-nav-add")||p.hasClass("pw-pagelist-show-all")){b.children(".pw-nav-dup").after(p.removeClass("separator").addClass("pw-nav-add"))}else{b.append(p)}});c.remove();b.addClass("navJSON").addClass("length"+parseInt(g.list.length)).hide();if(b.children().length){b.css("opacity",1).fadeIn("fast")}});return false})},setupInputfields:function(){var d=$("body").hasClass("AdminThemeUikitNoGrid");function e(j){$("form.uk-form-horizontal").each(function(){$(this).find(".InputfieldContent > .Inputfields").each(function(){var l=$(this);l.addClass("uk-form-vertical");l.find(".uk-form-label").removeClass("uk-form-label");l.find(".uk-form-controls").removeClass("uk-form-controls")});$(this).find(".InputfieldSubmit, .InputfieldButton").each(function(){$(this).find(".InputfieldContent").before("<div class='uk-form-label'>&nbsp;</div>")})});$(".InputfieldNoBorder.uk-card").removeClass("uk-card uk-card-default");$(".InputfieldIsOffset.InputfieldColumnWidthFirst").each(function(){var m=$(this);var l;do{l=m.next(".InputfieldColumnWidth");if(!l.length||l.hasClass("InputfieldColumnWidthFirst")){break}l.addClass("InputfieldIsOffset");m=l}while(true)});$(".Inputfields").each(function(){b($(this))});$(".ui-widget.Inputfield, .ui-widget-header.InputfieldHeader, .ui-widget-content.InputfieldContent").removeClass("ui-widget ui-widget-header ui-widget-content");$(".MarkupPagerNav:not(.uk-pagination)").each(function(){$(this).addClass("uk-pagination")});if(typeof j=="undefined"){j=$(".InputfieldForm")}var k=$("select:not([multiple]):not(.uk-select)",j);k.addClass("uk-select")}function b(j){$(".InputfieldRowFirst",j).removeClass("InputfieldRowFirst");$(".InputfieldRowLast",j).removeClass("InputfieldRowLast");var k=j.children(".Inputfield:not(.InputfieldStateHidden):eq(0)");if(!k.length){return}do{k.addClass("InputfieldRowFirst");k=k.next(".Inputfield:not(.InputfieldStateHidden)")}while(k.hasClass("InputfieldColumnWidth")&&!k.hasClass("InputfieldColumnWidthFirst"));k=j.children(".Inputfield:last-child");while(k.length&&k.hasClass("InputfieldStateHidden")){k=k.prev(".Inputfield")}do{k.addClass("InputfieldRowLast");if(!k.hasClass("InputfieldColumnWidth")||k.hasClass("InputfieldColumnWidthFirst")){break}k=k.prev(".Inputfield:not(.InputfieldStateHidden)")}while(k.hasClass("InputfieldColumnWidth"))}var i=[];function c(l,p){if(d&&typeof p!="undefined"){if(typeof l=="string"){p.addClass(l)}else{p.css("width",l+"%")}return""}var k="uk-width-1-1";var j=k;var n=false;if(typeof l=="string"&&typeof p!="undefined"){j=l;n=true}else{if(!l||l>=100){j=k}else{if(typeof i[l]!="undefined"){j="uk-width-"+i[l]}else{for(var m in ProcessWire.config.ukGridWidths){var o=ProcessWire.config.ukGridWidths[m];m=parseInt(m);if(l>=m){j=o;break}}if(j.length){i[l]=j;j="uk-width-"+j}}}}if(!n&&j&&j!=k){j+="@m"}if(typeof p!="undefined"){if(j&&p.hasClass(j)){}else{g(p);if(j){p.addClass(j)}}}return j}function g(k){var l=null;if(typeof k!="string"){l=k;k=l.attr("class")}if(k.indexOf("uk-width-")>-1){var j=k.replace(/uk-width-(\d-\d|expand)[@smxl]*\s*/g,"");if(l!==null){l.attr("class",j)}}return k}function a(j){if(!j){return}var q=j.parent().children(".Inputfield");var r=null;var l=0;var p=0;var t=0;var m=0;var k=false;function u(v,x){if(!k){return}if(typeof x=="undefined"){x=j}var w=x.attr("id");w=w.replace("wrap_Inputfield_","");console.log(w+" (combined width="+l+", w="+t+"): "+v)}function o(v){if(typeof v=="undefined"){v=r}if(v){if(d){v.addClass("InputfieldColumnWidthLast")}else{c("InputfieldColumnWidthLast uk-width-expand",v)}}}function n(){if(k){u("A: hidden",j)}m+=t;l+=t;if(r&&l>=95){m+=p;if(k){u("Updating last visible Inputfield to width="+m,r)}c(m,r);l=0;m=0;p=0;r=null}else{p+=t}}function s(){if(k){u("Skipping because full-width",j)}if(l<100&&r){o(r)}r=null;p=0;m=0;l=0}q.each(function(){j=$(this);var y=false;var x=false;var w=j.hasClass("InputfieldColumnWidth");var v=!w||j.hasClass("InputfieldColumnWidthFirst");if(v&&r&&l<100){o(r)}t=w?parseInt(j.attr("data-colwidth")):0;if(!t||t>=95){s();return}if(j.hasClass("InputfieldStateHidden")){n();return}if(!l||l>=100){l=0;x=true;y=false;if(k){u("B: starting new row",j)}}else{if(l+t>100){if(r){o(r)}l=0;x=true;if(k){u("C: start new row because width would exceed 100%",j)}}else{if(l+t==100){y=true;if(k){u("D: width is exactly 100%, so this is the last column",j)}}else{if(l+t>=95){y=true;t=100-l;if(k){u("D2: width is close enough to 100%, so this is the last column",j)}}else{if(k){u("E: not first or last column",j)}}}}}if(y){j.addClass("InputfieldColumnWidthLast")}else{j.removeClass("InputfieldColumnWidthLast")}if(x){j.addClass("InputfieldColumnWidthFirst");p=0}else{j.removeClass("InputfieldColumnWidthFirst")}if(y){r=null;l=0;m=0;if(p){t+=p}p=0}else{r=j;l+=t;m=t}c(t,j)});if(l<100&&r){o(r)}}var h=null;var f=function(l,k){var j=$(k);if(l.type=="showInputfield"){j.removeClass("uk-hidden")}else{j.show();j.addClass("uk-hidden")}a(j);if(h){return}h=setTimeout(function(){b(j.closest(".Inputfields"));var m=j.find(".Inputfields");if(m.length){m.each(function(){b($(this))})}h=null},100)};$(document).on("reloaded",function(){e($(this))});$(document).on("hideInputfield",f);$(document).on("showInputfield",f);$("body").addClass("InputfieldColumnWidthsInit");e()},setupTooltips:function(){$(".tooltip, .pw-tooltip").each(function(){$(this).removeClass("tooltip pw-tooltip");UIkit.tooltip($(this))})},linkTargetMainMouseoverEvent:function(){var b=$(this);var a=b.attr("href");if(a.length<2){return}if(b.attr("target")){return}if(b.parent("li").hasClass("PageListActionView")){b.attr("target","_top")}else{b.attr("target","main")}},logoClickEvent:function(){if($("body").hasClass("pw-layout-sidenav-init")){if($("#pw-admin-side").length){toggleSidebarPane()}else{UIkit.toggle("#offcanvas-nav").toggle()}}else{if(ProcessWire.config.adminTheme.logoAction==1){UIkit.toggle("#offcanvas-nav").toggle()}else{return true}}return false}};$(document).ready(function(){ProcessWireAdminTheme.ready()});